webpackJsonp([1],{112:function(t,e){},113:function(t,e){},114:function(t,e){},119:function(t,e,n){var a=n(24)(n(70),n(121),null,null);t.exports=a.exports},120:function(t,e,n){n(112),n(113);var a=n(24)(n(71),n(122),"data-v-1efee668",null);t.exports=a.exports},121:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.$emit("selected",t.instance.name)}}},[n("div",[t._v(t._s(t.instance.name))]),t._v(" "),n("div",[n("small",[t.instance.up?t._e():n("b",{staticClass:"text-danger"},[t._v("DOWN ")]),t._v("\n            "+t._s(t.instance.users)+" users / connections: "+t._s(t.instance.connections)+"\n        ")])])])},staticRenderFns:[]}},122:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card mb-3"},[n("div",{staticClass:"card-block d-flex"},[n("div",{staticStyle:{width:"90px","margin-right":"20px"}},[n("a",{attrs:{href:t.toot.account.url}},[n("img",{staticStyle:{"border-radius":"50%",width:"100%"},attrs:{src:t.toot.account.avatar,alt:"avatar"}})])]),t._v(" "),n("div",{staticStyle:{width:"100%"}},[n("div",{staticClass:"d-flex toot-header"},[n("a",{attrs:{href:t.toot.account.url,title:t.note}},[n("div",[t._v(t._s(t.toot.account.display_name)+" @"+t._s(t.toot.account.acct))])]),t._v(" "),n("a",{staticClass:"ml-auto text-right date",attrs:{href:t.toot.url}},[t._v(t._s(t.date))])]),t._v(" "),t.toot.spoiler_text?n("p",[t._v(t._s(t.toot.spoiler_text)+"\n                "),t.more?n("button",{staticClass:"btn btn-outline-secondary btn-sm",on:{click:function(e){e.preventDefault(),t.more=!1}}},[t._v("\n                    Close\n                ")]):n("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(e){e.preventDefault(),t.more=!0}}},[t._v("\n                    Read more...\n                ")])]):t._e(),t._v(" "),!t.toot.spoiler_text||t.more?n("div",{domProps:{innerHTML:t._s(t.toot.content)}}):t._e(),t._v(" "),t.toot.media_attachments.length?n("div",[t.toot.sensitive&&!t.allowSensitive?n("div",{staticClass:"text-center sensitive",on:{click:function(e){t.allowSensitive=!0}}},[t._v("\n                    Sensitive content (click to show)\n                ")]):n("div",t._l(t.toot.media_attachments,function(t){return n("a",{attrs:{href:t.url}},[n("img",{staticClass:"img-fluid img-thumbnail",attrs:{src:t.preview_url,alt:""}})])}))]):t._e()])])])},staticRenderFns:[]}},123:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"container"},[n("h1",[t._v("PTL Viewer")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t.error?n("div",{staticClass:"alert alert-warning"},[t._v(t._s(t.error))]):t._e(),t._v(" "),n("form",{attrs:{action:"/",method:"post"},on:{submit:function(e){e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"form-group row"},[n("label",{staticClass:"col-4 col-md-2",attrs:{for:"domain"}},[t._v("Domain")]),t._v(" "),n("div",{staticClass:"col-8 col-md-4"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.domain,expression:"domain"}],staticClass:"form-control",attrs:{type:"text",placeholder:"mstdn.jp",id:"domain"},domProps:{value:t.domain},on:{input:[function(e){e.target.composing||(t.domain=e.target.value)},t.inputDomain]}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.suggestEnabled&&t.filteredInstances.length,expression:"suggestEnabled && filteredInstances.length"}],staticClass:"dropdown-menu",staticStyle:{display:"block",right:"0"}},t._l(t.filteredInstances,function(e){return n("instance",{key:e.name,attrs:{instance:e},on:{selected:t.instanceSelected}},[t._v("err")])}))]),t._v(" "),n("div",{staticClass:"col-12 col-md-6"},[n("input",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"Load"}}),t._v(" "),n("label",{staticClass:"custom-control custom-checkbox ml-3"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.local,expression:"local"}],staticClass:"custom-control-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.local)?t._i(t.local,null)>-1:t.local},on:{__c:function(e){var n=t.local,a=e.target,o=!!a.checked;if(Array.isArray(n)){var s=t._i(n,null);o?s<0&&(t.local=n.concat(null)):s>-1&&(t.local=n.slice(0,s).concat(n.slice(s+1)))}else t.local=o}}}),t._v(" "),n("span",{staticClass:"custom-control-indicator"}),t._v(" "),n("span",{staticClass:"custom-control-description"},[t._v("Local")])])])])]),t._v(" "),n("div",[t._l(t.toots,function(t){return n("div",{key:t.id},[n("Toot",{attrs:{toot:t}})],1)}),t._v(" "),t.currentUri&&!t.loading?n("div",{staticClass:"text-center pb-3 more",staticStyle:{cursor:"pointer"},on:{click:function(e){e.preventDefault(),t.loadMore(e)}}},[t._v("more")]):t.loading?n("div",{staticClass:"text-center pb-3"},[t._v("Loading...")]):t._e()],2)])])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"lead"},[t._v("\n          マストドンの公開タイムラインをみるやつ。inspired by "),n("a",{attrs:{href:"http://junk.azyobuzi.net/mastodonptl/"}},[t._v("junk.azyobuzi.net/mastodonptl/")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",[t._v("github: "),n("a",{attrs:{href:"https://github.com/hinaloe/public-toot-viewer"}},[n("span",{staticClass:"hidden-xs-down"},[t._v("hinaloe/")]),t._v("public-toot-viewer")]),t._v(" by "),n("a",{attrs:{href:"https://github.com/hinaloe/"}},[t._v("hinaloe")]),t._v(" on "),n("a",{attrs:{href:"https://mdn.hinaloe.net"}},[t._v("ひな丼")])])}]}},47:function(t,e){},48:function(t,e,n){n(114);var a=n(24)(n(69),n(123),null,null);t.exports=a.exports},68:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(49),o=n(48),s=n.n(o),i=n(47);n.n(i);a.a.config.productionTip=!1,new a.a({el:"#app",template:"<App/>",components:{App:s.a}})},69:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(74),o=n.n(a),s=n(73),i=n.n(s),r=n(75),c=n.n(r),l=n(120),u=n.n(l),d=n(119),v=n.n(d),m=n(50),p=n.n(m);e.default={data:function(){return{toots:[],instances:[],suggestEnabled:!1,domain:"",local:!1,loading:!1,currentUri:null,error:""}},name:"app",components:{Toot:u.a,Instance:v.a},mounted:function(){var t=this;if(!window.URLSearchParams)return void(this.error="お使いのブラウザーはURLSearchParamsに対応していないため、このアプリケーションは利用できません。最新の Chrome または Firefox をご利用ください。");setInterval(function(){if(t.currentUri&&!t.loading&&t.toots.length){var e=t.currentUri;e.searchParams.delete("max_id"),e.searchParams.set("since_id",t.toots[0].id),p.a.get(e.href).then(function(e){var n;(n=t.toots).unshift.apply(n,c()(e.data))})}},3e4),p.a.get("https://instances.mastodon.xyz/instances.json").then(function(e){if(!Array.isArray(e.data))return i.a.reject(new Error("Invalid response"));t.instances=e.data}).catch(function(e){t.error=e.message})},computed:{filteredInstances:function(){var t=this;return this.instances.filter(function(e){return o()(e.name,t.domain)}).slice(0,6)}},methods:{getApiUri:function(){var t=new URL(o()(this.domain,"://")?this.domain:"https://"+this.domain);return t.pathname="/api/v1/timelines/public",t},submit:function(){var t=this;this.error="",this.toots=[],this.loading=!0,this.suggestEnabled=!1,i.a.resolve().then(function(){if(!o()(t.domain,"."))throw new Error("Invalid domain");var e=t.getApiUri();return t.currentUri=e,e.searchParams.set("limit",40),t.local&&e.searchParams.append("local",!0),p.a.get(e.href)}).then(function(e){t.toots=e.data,t.loading=!1,window.ga("send","event","Toots","load",t.domain)}).catch(function(e){t.error=e.message})},loadMore:function(){var t=this;this.loading=!0,i.a.resolve().then(function(){var e=t.currentUri;return e.searchParams.delete("since_id"),e.searchParams.set("max_id",t.toots[t.toots.length-1].id),p.a.get(e.href)}).then(function(e){var n;(n=t.toots).push.apply(n,c()(e.data)),t.loading=!1}).catch(function(e){t.error=e.message,t.loading=!1})},instanceSelected:function(t){this.domain=t,this.submit()},inputDomain:function(){this.suggestEnabled=!0}}}},70:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{instance:Object}}},71:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n(118),o=n.n(a);e.default={props:{toot:{type:Object,required:!0}},data:function(){return{allowSensitive:!1,more:!1}},computed:{date:function(){var t=new Date(this.toot.created_at);return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+("00"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},note:function(){return o()(this.toot.account.note.replace(/<br(?: \/)?>/g,"\n"))}}}}},[68]);
//# sourceMappingURL=app.d0271d10d4b885ae868a.js.map