webpackJsonp([1],{103:function(t,e,a){"use strict";var n=a(47),s=a(110),i=a(27);var o=function(t){a(104)},r=Object(i.a)(n.a,s.a,s.b,!1,o,"data-v-0e7fdefe",null);e.a=r.exports},104:function(t,e){},110:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("article",{staticClass:"card mb-3"},[a("div",{staticClass:"card-body d-flex"},[a("div",{staticStyle:{width:"90px","margin-right":"20px"}},[a("a",{attrs:{href:t.toot.account.url}},[a("img",{staticStyle:{"border-radius":"50%",width:"100%"},attrs:{src:t.toot.account.avatar,alt:"avatar"}})])]),t._v(" "),a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"d-flex toot-header"},[a("a",{attrs:{href:t.toot.account.url,title:t.note}},[a("div",[a("span",{staticClass:"name"},[t._v(t._s(t.toot.account.display_name))]),t._v(" "),a("span",{staticClass:"acct"},[t._v("@"+t._s(t.toot.account.acct))])])]),t._v(" "),a("a",{staticClass:"ml-auto text-right date",attrs:{href:t.toot.url}},[t._v(t._s(t.date))])]),t._v(" "),t.toot.spoiler_text?a("p",[t._v("\n        "+t._s(t.toot.spoiler_text)+"\n        "),t.more?a("button",{staticClass:"btn btn-outline-secondary btn-sm",on:{click:function(e){e.preventDefault(),t.more=!1}}},[t._v("\n          Close\n        ")]):a("button",{staticClass:"btn btn-outline-primary btn-sm",on:{click:function(e){e.preventDefault(),t.more=!0}}},[t._v("\n          Read more...\n        ")])]):t._e(),t._v(" "),!t.toot.spoiler_text||t.more?a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.content)}}):t._e(),t._v(" "),t.toot.media_attachments.length?a("div",[t.toot.sensitive&&!t.allowSensitive?a("div",{staticClass:"text-center sensitive",on:{click:function(e){t.allowSensitive=!0}}},[t._v("\n          Sensitive content (click to show)\n        ")]):a("div",t._l(t.toot.media_attachments,function(t){return a("a",{key:t.id,attrs:{href:t.url}},[a("img",{staticClass:"img-fluid img-thumbnail",attrs:{src:t.preview_url,alt:""}})])}),0)]):t._e()])])])},s=[]},111:function(t,e,a){"use strict";var n=a(48),s=a(112),i=a(27),o=Object(i.a)(n.a,s.a,s.b,!1,null,null,null);e.a=o.exports},112:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.$emit("selected",t.instance.name)}}},[a("div",[t._v(t._s(t.instance.name))]),t._v(" "),a("div",[a("small",[t.instance.up?t._e():a("b",{staticClass:"text-danger"},[t._v("DOWN ")]),t._v("\n      "+t._s(t.instance.users)+" users / connections: "+t._s(t.instance.connections)+"\n    ")])])])},s=[]},130:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return s});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"container"},[a("h1",[t._v("PTL Viewer")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t.error?a("div",{staticClass:"alert alert-warning"},[t._v("\n      "+t._s(t.error)+"\n    ")]):t._e(),t._v(" "),a("form",{attrs:{action:"/",method:"post"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-4 col-md-2 col-form-label",attrs:{for:"domain"}},[t._v("Domain")]),t._v(" "),a("div",{staticClass:"col-8 col-md-4"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.domain,expression:"domain"}],staticClass:"form-control",attrs:{id:"domain",type:"text",placeholder:"mstdn.jp"},domProps:{value:t.domain},on:{input:[function(e){e.target.composing||(t.domain=e.target.value)},t.inputDomain]}}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.suggestEnabled&&t.filteredInstances.length,expression:"suggestEnabled && filteredInstances.length"}],staticClass:"dropdown-menu",staticStyle:{display:"block",right:"0"}},t._l(t.filteredInstances,function(e){return a("instance",{key:e.name,attrs:{instance:e},on:{selected:t.instanceSelected}},[t._v("\n              err\n            ")])}),1)]),t._v(" "),a("div",{staticClass:"col-12 col-md-6"},[a("input",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"Load"}}),t._v(" "),a("div",{staticClass:"custom-control custom-checkbox custom-control-inline ml-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.local,expression:"local"}],staticClass:"custom-control-input",attrs:{id:"is-local",type:"checkbox"},domProps:{checked:Array.isArray(t.local)?t._i(t.local,null)>-1:t.local},on:{change:function(e){var a=t.local,n=e.target,s=!!n.checked;if(Array.isArray(a)){var i=t._i(a,null);n.checked?i<0&&(t.local=a.concat([null])):i>-1&&(t.local=a.slice(0,i).concat(a.slice(i+1)))}else t.local=s}}}),t._v(" "),a("label",{staticClass:"custom-control-label",attrs:{for:"is-local"}},[t._v("Local")])])])])]),t._v(" "),a("div",[t._l(t.toots,function(t){return a("div",{key:t.id},[a("Toot",{attrs:{toot:t}})],1)}),t._v(" "),t.currentUri&&!t.loading?a("div",{staticClass:"text-center pb-3 more",staticStyle:{cursor:"pointer"},on:{click:function(e){return e.preventDefault(),t.loadMore(e)}}},[t._v("\n        more\n      ")]):t.loading?a("div",{staticClass:"text-center pb-3"},[t._v("\n        Loading...\n      ")]):t._e()],2)])])},s=[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"lead"},[this._v("\n      マストドンの公開タイムラインをみるやつ。inspired by "),e("a",{attrs:{href:"http://junk.azyobuzi.net/mastodonptl/"}},[this._v("junk.azyobuzi.net/mastodonptl/")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n      github: "),e("a",{attrs:{href:"https://github.com/hinaloe/public-toot-viewer"}},[e("span",{staticClass:"hidden-xs-down"},[this._v("hinaloe/")]),this._v("public-toot-viewer")]),this._v(" by "),e("a",{attrs:{href:"https://github.com/hinaloe/"}},[this._v("hinaloe")]),this._v(" on "),e("a",{attrs:{href:"https://mdn.hinaloe.net"}},[this._v("ひな丼")])])}]},131:function(t,e){},29:function(t,e,a){"use strict";var n=a(64),s=a.n(n),i=a(92),o=a.n(i),r=a(97),c=a.n(r),l=a(103),u=a(111),d=a(113),h=a.n(d);e.a={name:"App",components:{Toot:l.a,Instance:u.a},data:function(){return{toots:[],instances:[],suggestEnabled:!1,domain:"",local:!1,loading:!1,currentUri:null,error:""}},computed:{filteredInstances:function(){var t=this;return this.instances.filter(function(e){return c()(e.name,t.domain)}).slice(0,6)}},mounted:function(){var t=this;if(window.URLSearchParams){setInterval(function(){if(t.currentUri&&!t.loading&&t.toots.length){var e=t.currentUri;e.searchParams.delete("max_id"),e.searchParams.set("since_id",t.toots[0].id),h.a.get(e.href).then(function(e){var a;(a=t.toots).unshift.apply(a,o()(e.data))})}},3e4),h.a.get("https://instances.social/instances.json").then(function(e){if(!Array.isArray(e.data))return s.a.reject(new Error("Invalid response"));t.instances=e.data}).catch(function(e){t.error=e.message});var e=new URL(location.href);e.searchParams.has("domain")&&(this.domain=e.searchParams.get("domain"),this.local=e.searchParams.has("local")&&!["false","","0","no"].includes(e.searchParams.get("local")),this.submit())}else this.error="お使いのブラウザーはURLSearchParamsに対応していないため、このアプリケーションは利用できません。最新の Chrome または Firefox をご利用ください。"},methods:{getApiUri:function(){var t=new URL(c()(this.domain,"://")?this.domain:"https://"+this.domain);return t.pathname="/api/v1/timelines/public",t},submit:function(){var t=this;this.error="",this.toots=[],this.loading=!0,this.suggestEnabled=!1,s.a.resolve().then(function(){if(!c()(t.domain,"."))throw new Error("Invalid domain");var e=t.getApiUri();return t.currentUri=e,e.searchParams.set("limit",40),t.local&&e.searchParams.append("local",!0),h.a.get(e.href)}).then(function(e){t.toots=e.data,t.loading=!1,t.updateSearchParams(),window.ga("send","event","Toots","load",t.domain)}).catch(function(e){t.error=e.message})},loadMore:function(){var t=this;this.loading=!0,s.a.resolve().then(function(){var e=t.currentUri;return e.searchParams.delete("since_id"),e.searchParams.set("max_id",t.toots[t.toots.length-1].id),h.a.get(e.href)}).then(function(e){var a;(a=t.toots).push.apply(a,o()(e.data)),t.loading=!1}).catch(function(e){t.error=e.message,t.loading=!1})},instanceSelected:function(t){this.domain=t,this.submit()},inputDomain:function(){this.suggestEnabled=!0},updateSearchParams:function(){var t="?domain="+this.domain+"&local="+this.local.toString();location.search!==t&&history.pushState(null,null,t)}}}},47:function(t,e,a){"use strict";var n=a(105),s=a.n(n),i=a(108),o=a.n(i),r=a(109),c=a.n(r);e.a={props:{toot:{type:Object,required:!0}},data:function(){return{allowSensitive:!1,more:!1}},computed:{date:function(){var t=new Date(this.toot.created_at);return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours()+":"+("00"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2)},note:function(){return o()(this.toot.account.note.replace(/<br(?: \/)?>/g,"\n"))},content:function(){var t=c()(this.toot.content,{allowedTags:["h3","h4","h5","h6","blockquote","p","a","ul","ol","nl","li","b","i","strong","em","strike","code","hr","br","div","table","thead","caption","tbody","tr","th","td","pre","span"],allowedAttributes:{a:["href","target"],img:["src","alt"],"*":["class","title","rel"]}});if(Array.isArray(this.toot.emojis)&&this.toot.emojis.length){var e=!0,a=!1,n=void 0;try{for(var i,o=s()(this.toot.emojis);!(e=(i=o.next()).done);e=!0){var r=i.value;r.shortcode&&r.url&&this.validateShortCode(r.shortcode)&&(t=t.replace(new RegExp(":"+r.shortcode+":","g"),'<img src="'+r.url+'" draggable="false" alt=":'+r.shortcode+':" title=":'+r.shortcode+':" class="inline-emoji">'))}}catch(t){a=!0,n=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw n}}}return t}},methods:{validateShortCode:function(t){return/^[a-zA-Z0-9_]+$/.test(t)}}}},48:function(t,e,a){"use strict";e.a={props:{instance:{type:Object,required:!0}}}},57:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(58),s=a(61),i=a(131);a.n(i);n.a.config.productionTip=!1,new n.a({el:"#app",components:{App:s.a},template:"<App/>"})},61:function(t,e,a){"use strict";var n=a(29),s=a(130),i=a(27);var o=function(t){a(62)},r=Object(i.a)(n.a,s.a,s.b,!1,o,null,null);e.a=r.exports},62:function(t,e){}},[57]);